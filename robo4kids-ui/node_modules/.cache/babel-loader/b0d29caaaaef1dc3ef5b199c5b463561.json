{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/antonfu/Documents/Capstone Project/Robo4Kids/roboblockly/src/components/runCode.js\";\nimport React, { useState } from 'react';\nimport Amplify from 'aws-amplify';\nimport awsconfig from './../aws-exports';\nimport '@aws-amplify/ui/dist/style.css';\nimport Blockly from 'blockly';\nimport 'blockly/javascript';\nimport { PubSub, Auth } from 'aws-amplify';\nimport { AWSIoTProvider } from '@aws-amplify/pubsub/lib/Providers';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport get_function from './customBlocks/direction_factory';\nAmplify.configure(awsconfig);\nAmplify.addPluggable(new AWSIoTProvider({\n  aws_pubsub_region: 'us-west-2',\n  aws_pubsub_endpoint: 'wss://ajlhtk9kwdt15-ats.iot.us-west-2.amazonaws.com/mqtt'\n}));\n\nfunction RunCode(props) {\n  var list_funtions = [];\n\n  async function run() {\n    //console.log(props.code);\n    createList(props.code);\n    console.log(list_funtions);\n    window.LoopTrap = 100;\n    Blockly.JavaScript.INFINITE_LOOP_TRAP = 'if(--window.LoopTrap == 0) throw \"Infinity loop\";\\n';\n\n    for await (let l of list_funtions) {\n      await l();\n    }\n\n    list_funtions = [];\n    Blockly.JavaScript.INFINITE_LOOP_TRAP = null;\n  }\n\n  function createList(code) {\n    console.log(\"run\", code);\n    let i = 0;\n\n    while (i < code.length - 1) {\n      if (code[i] === ',' || code[i] === '(' || code[i] === ')') {\n        i++;\n        continue;\n      }\n\n      const f_position = code.substring(i).indexOf(',') + i;\n      var comand = code.substring(i, f_position);\n      i = f_position;\n\n      if (comand[0] === \"X\") {\n        //Asolating the input\n        const fp_input = code.substring(i + 1).indexOf(',') + i + 1;\n        var input = parseInt(code.substring(i + 1, fp_input)); //Asolating the length of statment\n\n        const fp_lenght = code.substring(fp_input + 1).indexOf(',') + fp_input + 1;\n        var length = parseInt(code.substring(fp_input + 1, fp_lenght));\n        var inside_code = code.substring(fp_lenght + 2, length + fp_lenght);\n        get_function(comand)(input, inside_code, createList);\n        i = length + fp_lenght;\n        console.log('input, length, inside_code', input, length, inside_code);\n      } else {\n        list_funtions.push(get_function(comand));\n      }\n\n      i++;\n    }\n  }\n\n  async function send(linear, angular) {\n    var rawText = {\n      linear: {\n        x: linear,\n        y: 0,\n        z: 0\n      },\n      angular: {\n        x: 0,\n        y: 0,\n        z: angular\n      }\n    };\n    await PubSub.publish('joystick1', rawText);\n    console.log('Sending: ' + rawText);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: run,\n      type: \"button\",\n      class: \"btn btn-warning btn-lg btn-block\",\n      children: \" Run Code\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n}\n\n_c = RunCode;\nexport default RunCode;\n\nvar _c;\n\n$RefreshReg$(_c, \"RunCode\");","map":{"version":3,"sources":["/Users/antonfu/Documents/Capstone Project/Robo4Kids/roboblockly/src/components/runCode.js"],"names":["React","useState","Amplify","awsconfig","Blockly","PubSub","Auth","AWSIoTProvider","get_function","configure","addPluggable","aws_pubsub_region","aws_pubsub_endpoint","RunCode","props","list_funtions","run","createList","code","console","log","window","LoopTrap","JavaScript","INFINITE_LOOP_TRAP","l","i","length","f_position","substring","indexOf","comand","fp_input","input","parseInt","fp_lenght","inside_code","push","send","linear","angular","rawText","x","y","z","publish"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport Amplify from 'aws-amplify';\nimport awsconfig from './../aws-exports';\nimport '@aws-amplify/ui/dist/style.css';\nimport Blockly from 'blockly';\nimport 'blockly/javascript';\n\nimport { PubSub, Auth } from 'aws-amplify';\nimport { AWSIoTProvider } from '@aws-amplify/pubsub/lib/Providers';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport get_function from './customBlocks/direction_factory'\n\n\n\nAmplify.configure(awsconfig);\nAmplify.addPluggable(new AWSIoTProvider({\n aws_pubsub_region: 'us-west-2',\n aws_pubsub_endpoint: 'wss://ajlhtk9kwdt15-ats.iot.us-west-2.amazonaws.com/mqtt',\n}));\n\n\n\nfunction RunCode(props) {\n\n\n  var list_funtions = []\n\n\n  async function run()\n    {\n\n      //console.log(props.code);\n\n\n      createList(props.code)\n      console.log(list_funtions)\n      window.LoopTrap = 100;\n      Blockly.JavaScript.INFINITE_LOOP_TRAP = 'if(--window.LoopTrap == 0) throw \"Infinity loop\";\\n'\n      for await(let l of list_funtions) {\n            await l();\n\n          }\n      list_funtions = []\n      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;\n    }\n\n\n  function createList(code)\n        {\n        console.log(\"run\", code)\n       \tlet i = 0;\n      \twhile( i < code.length-1){\n\n    \t\tif(code[i]===',' || code[i]==='(' ||code[i]===')'){\n    \t\t\ti++\n    \t\t\tcontinue;\n    \t\t}\n\n    \t\tconst f_position = code.substring(i,).indexOf(',') + i;\n      \t\tvar comand = code.substring(i, f_position);\n      \t\ti = f_position;\n\n      \t\tif(comand[0]=== \"X\"){\n            //Asolating the input\n      \t\t\tconst fp_input = code.substring(i+1).indexOf(',') +i+1;\n      \t\t\tvar input = parseInt(code.substring(i+1, fp_input));\n\n      \t\t\t//Asolating the length of statment\n      \t\t\tconst fp_lenght = code.substring(fp_input+1).indexOf(',') +fp_input+1;\n      \t\t\tvar length = parseInt(code.substring(fp_input+1, fp_lenght));\n\n      \t\t\tvar inside_code = code.substring(fp_lenght+2,length+fp_lenght)\n      \t\t\tget_function(comand)(input,inside_code, createList);\n      \t\t\ti = length+fp_lenght;\n\n      \t\t\tconsole.log('input, length, inside_code',input,length, inside_code)\n\n      \t\t}\n\n\n    \t\telse{\n    \t\tlist_funtions.push(get_function(comand));\n    \t\t}\n\n    \t\ti++\n    \t}\n\n\n     }\n\n\n  async function send(linear, angular){\n    var rawText = {\n        linear: {\n            x: linear,\n            y: 0,\n            z: 0\n        },\n        angular: {\n            x: 0,\n            y: 0,\n            z: angular\n        }}\n    await PubSub.publish('joystick1', rawText);\n    console.log('Sending: ' + rawText)\n  }\n\n\n\n\nreturn(\n  <>\n    <button onClick={run} type=\"button\" class=\"btn btn-warning btn-lg btn-block\"> Run Code</button>\n  </>\n)\n\n}\n\nexport default RunCode;\n"]},"metadata":{},"sourceType":"module"}